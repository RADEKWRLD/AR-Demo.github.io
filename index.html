<!DOCTYPE html>
<html>

<head>
    <title>AR.js Interactive App</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@latest/aframe/build/aframe-ar.min.js"></script>

    <script>
        AFRAME.registerComponent('gesture-handler', {
            init: function () {
                let model = this.el;
                let initialScale = model.getAttribute('scale');
                let pinchStartDistance = 0;
                let lastRotation = 0;


                model.addEventListener('click', function () {
                    if (sound) {
                        sound.currentTime = 0;
                        sound.play().catch(error => {
                            console.warn("音频播放失败：", error);
                        });
                    } else {
                        console.warn("找不到音频元素！");
                    }
                });
                document.addEventListener('touchstart', (event) => {
                    if (event.touches.length === 1) {
                        lastX = event.touches[0].clientX;
                    }
                });

                document.addEventListener('touchmove', (event) => {
                    if (event.touches.length === 1) {
                        let deltaX = event.touches[0].clientX - lastX;
                        model.object3D.rotation.y += deltaX * rotationSpeed;
                        lastX = event.touches[0].clientX;
                    }
                });
            }
        });

        function getDistance(touch1, touch2) {
            let dx = touch1.clientX - touch2.clientX;
            let dy = touch1.clientY - touch2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
    </script>
</head>

<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <a-assets>
            <audio id="sound" src="assets/clickSound.mp3"></audio>
        </a-assets>

        <a-marker type="pattern" url="assets/pattern-images.patt">
            <a-entity id="model" gltf-model="assets/yellow_duck.glb" position="0 -0.5 0" scale="0.5 0.5 0.5"
                rotate-in-place="speed: 1">
            </a-entity>
        </a-marker>

        <a-camera position="0 0 0"></a-camera>
    </a-scene>
</body>

</html>